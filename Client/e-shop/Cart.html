<!DOCTYPE html>
<html>
<head>
    <title>Panier</title>
    <style>
        /* Styles CSS */
        .cart-item {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .item-image {
            width: 100px;
            height: 100px;
            margin-right: 20px;
        }

        .item-description {
            flex-grow: 1;
        }

        .quantity-select {
            width: 50px;
        }

        .item-price {
            font-weight: bold;
        }

        #total-price {
            font-size: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Panier</h1>

    <div id="cartProduct">
        
    </div>

    <!-- Prix total du panier -->
    <p>Prix total: <span id="total-price">0</span>$</p>

    <script>
        // Fonction pour supprimer un article du panier
        function removeCartItem(button) {
            const cartItem = button.parentNode;
            cartItem.remove();
            updateTotalPrice(); // Met à jour le prix total après la suppression
        }

        // Fonction pour mettre à jour le prix d'un article en fonction de la quantité sélectionnée
        function updatePrice(quantityId, priceId, price) {
            const quantitySelect = document.getElementById(quantityId);
            const quantity = parseInt(quantitySelect.value);
            const totalPrice = price * quantity;
            document.getElementById(priceId).innerText = totalPrice;
            updateTotalPrice(); // Met à jour le prix total après la modification
        }

        // Fonction pour mettre à jour le prix total en additionnant les prix de tous les articles
        function updateTotalPrice() {
            let totalPrice = 0;
            const prices = document.getElementsByClassName('initial-price');
            for (let i = 0; i < prices.length; i++) {
                totalPrice += parseInt(prices[i].innerText);
            }
            document.getElementById('total-price').innerText = totalPrice;
        }

        // Fonction pour créer un cart-item avec les données du produit
        function createCartItem(product) {
            // Créer un élément div pour le cart-item
            const cartItem = document.createElement('div');
            cartItem.classList.add('cart-item');

            // Créer l'image du produit
            const itemImage = document.createElement('img');
            itemImage.src = product.image;
            itemImage.alt = product.name;
            itemImage.classList.add('item-image');
            cartItem.appendChild(itemImage);

            // Créer la description du produit
            const itemDescription = document.createElement('div');
            itemDescription.classList.add('item-description');

            const itemName = document.createElement('h3');
            itemName.textContent = product.name;
            itemDescription.appendChild(itemName);

            const itemDescriptionText = document.createElement('p');
            itemDescriptionText.textContent = product.description;
            itemDescription.appendChild(itemDescriptionText);

            const itemQuantity = document.createElement('div');
            itemQuantity.classList.add('item-quantity');

            const quantityLabel = document.createElement('label');
            quantityLabel.setAttribute('for', 'quantity' + product.id);
            quantityLabel.classList.add('quantity-label');
            quantityLabel.textContent = 'Quantité:';
            itemQuantity.appendChild(quantityLabel);

            const quantitySelect = document.createElement('select');
            quantitySelect.id = 'quantity' + product.id;
            quantitySelect.classList.add('quantity-select');
            quantitySelect.setAttribute('data-price-id', 'price' + product.id);
            quantitySelect.onchange = function () {
                updatePrice('quantity' + product.id, 'price' + product.id, product.price);
            };
            itemQuantity.appendChild(quantitySelect);

            for (let i = 1; i <= 5; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                quantitySelect.appendChild(option);
            }

            itemDescription.appendChild(itemQuantity);

            const itemPrice = document.createElement('p');
            itemPrice.classList.add('item-price');
            itemPrice.innerHTML = 'Prix: <span id="price' + product.id + '" class="initial-price">' + product.price + '</span>$';
            itemDescription.appendChild(itemPrice);

            cartItem.appendChild(itemDescription);

            const deleteButton = document.createElement('button');
            deleteButton.classList.add('delete-button');
            deleteButton.textContent = 'Supprimer';
            deleteButton.onclick = function () {
                removeCartItem(deleteButton);
            };
            cartItem.appendChild(deleteButton);

            return cartItem;
        }

        // Récupérer la chaîne JSON du stockage local
        var productJSON = localStorage.getItem('cartProduct');

        // Vérifier si la chaîne JSON existe
        if (productJSON) {
            // Convertir lachaîne JSON en objet JavaScript
            var product = JSON.parse(productJSON);

            // Créer un cart-item avec les données du produit
            var cartItem = createCartItem(product);

            // Ajouter le cart-item à la section cartProduct
            var cartProductElement = document.getElementById('cartProduct');
            cartProductElement.appendChild(cartItem);

            // Mettre à jour le prix total
            updateTotalPrice();
        }
    </script>
</body>
</html>